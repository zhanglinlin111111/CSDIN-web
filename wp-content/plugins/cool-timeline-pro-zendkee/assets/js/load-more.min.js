jQuery(function($){if("undefined"!=typeof ctlloadmore&&void 0!==ctlloadmore.attribute){var page=2,loading=!1;1==$(".cool_timeline").find(".ctl_load_more").attr("data-max-num-pages")&&$(".cool_timeline").find(".ctl_load_more").hide(),$("body").on("click",".ctl_load_more",function(){var timeline_wrp=$(this).parents(".cool_timeline"),org_label=$(this).text(),loading_text=$(this).attr("data-loading-text"),button=timeline_wrp.find(".ctl_load_more"),type=$(this).attr("data-timeline-type"),last_year=timeline_wrp.find(".timeline-year:last").data("section-title");if("compact"==type)var last_year=timeline_wrp.find(".compact-year:last").data("section-title");else var last_year=timeline_wrp.find(".timeline-year:last").data("section-title");var allAtts=ctlloadmore.attribute,alternate=timeline_wrp.find(".timeline-post:last").data("alternate");if($(".ct-cat-filters").length&&$(".ct-cat-filters").hasClass("active-category")){var filterCat=$(".active-category").data("term-slug");allAtts.category=filterCat}if(!loading){$(this).html(loading_text);var max_pages=$(this).attr("data-max-num-pages"),max_page_num=parseInt(max_pages)+1;loading=!0;var data={action:"ctl_ajax_load_more",page:page,last_year:last_year,alternate:alternate,attribute:allAtts};$.post(ctlloadmore.url,data,function(res){if(res.success){var $grid;if("compact"==type)ctl_compact_settings(timeline_wrp.find(".clt-compact-cont").append(res.data));else timeline_wrp.find(".cooltimeline_cont").append(res.data);enable_navi(timeline_wrp),re_enable_pp(timeline_wrp),button.html(org_label),loading=!1,(page+=1)>=max_page_num&&$(".ctl_load_more").hide()}}).fail(function(xhr,textStatus,e){console.log(xhr.responseText)})}})}if("undefined"!=typeof ct_load_more&&void 0!==ct_load_more.attribute){var page=2,loading=!1;$("body").on("click",".ctl_load_more",function(){var timeline_wrp=$(this).parents(".cool_timeline"),button=timeline_wrp.find(".ctl_load_more"),type=$(this).attr("data-timeline-type");if("compact"==type)var last_year=timeline_wrp.find(".compact-year:last").data("section-title");else var last_year=timeline_wrp.find(".timeline-year:last").data("section-title");var alternate=timeline_wrp.find(".timeline-post:last").data("alternate"),org_label=$(this).text(),loading_text=$(this).attr("data-loading-text"),allAtts=ct_load_more.attribute;if($(".ct-cat-filters").length&&$(".ct-cat-filters").hasClass("active-category")){var filterCat=$(".active-category").data("term-slug");allAtts["post-category"]=filterCat}if(!loading){$(this).html(loading_text);var max_pages=$(this).attr("data-max-num-pages"),max_page_num=parseInt(max_pages)+1;loading=!0;var data={action:"ct_ajax_load_more",page:page,last_year:last_year,alternate:alternate,attribute:allAtts};$.post(ct_load_more.url,data,function(res){if(res.success){var $grid;if("compact"==type)ctl_compact_settings(timeline_wrp.find(".clt-compact-cont").append(res.data));else timeline_wrp.find(".cooltimeline_cont").append(res.data);enable_navi(timeline_wrp),re_enable_pp(timeline_wrp),page+=1,loading=!1,button.html(org_label),timeline_wrp.find("a[class^='ctl_prettyPhoto']").prettyPhoto({social_tools:!1}),timeline_wrp.find("a[rel^='ctl_prettyPhoto']").prettyPhoto({social_tools:!1}),page>=max_page_num&&button.hide()}}).fail(function(xhr,textStatus,e){console.log(xhr.responseText)})}})}function ctl_compact_settings($grid){null!=$grid&&($grid.masonry("reloadItems"),$grid.imagesLoaded().progress(function(){$grid.masonry("layout")}),$grid.on("layoutComplete",function(){var leftPos=0,topPosDiff;$grid.find(".timeline-mansory").each(function(index){(leftPos=$(this).position().left)<=0?$(this).removeClass("ctl-right").addClass("ctl-left"):$(this).removeClass("ctl-left").addClass("ctl-right"),(topPosDiff=$(this).position().top-$(this).prev().position().top)<40&&($(this).find(".timeline-icon").css({"margin-top":"32px"}),$(this).prev().find(".timeline-icon").css({"margin-top":"6px"}),$(this).find(".content-title").removeClass("compact-afterup").addClass("compact-afterdown"),$(this).prev().find(".content-title").removeClass("compact-afterdown").addClass("compact-afterup"))}),AOS.refreshHard()}))}function re_enable_pp(timeline_wrp){null!=timeline_wrp&&(timeline_wrp.find("a[class^='ctl_prettyPhoto']").prettyPhoto({social_tools:!1}),timeline_wrp.find("a[rel^='ctl_prettyPhoto']").prettyPhoto({social_tools:!1}))}function enable_navi(timeline_wrp){if(null!=timeline_wrp){var wrp_id=timeline_wrp.attr("id");$("#"+wrp_id+"-navi").remove();var pagination=timeline_wrp.attr("data-pagination"),pagination_position=timeline_wrp.attr("data-pagination-position"),bull_cls="",position="";"left"==pagination_position?(bull_cls="section-bullets-left",position="left"):"right"==pagination_position?(bull_cls="section-bullets-right",position="right"):"bottom"==pagination_position&&(bull_cls="section-bullets-bottom",position="bottom"),$("body").sectionScroll({bulletsClass:bull_cls,sectionsClass:"scrollable-section",scrollDuration:1500,titles:!0,topOffset:2,easing:"",id:wrp_id,position:position})}}$(".ct-cat-filters").on("click",function($event){$event.preventDefault(),$(".cat-filter-wrp ul li a").removeClass("active-category"),$(this).addClass("active-category");var cat_name=$(this).text(),parent_wrp=$(this).parents(".cool_timeline"),preloader=parent_wrp.find(".filter-preloaders");preloader.show();var parent_id,navigation="#"+parent_wrp.attr("id")+"-navi",termSlug=$(this).data("term-slug"),totalPosts=parseInt($(this).data("post-count")),action=$(this).data("action"),tm_type=$(this).data("tm-type"),type=$(this).data("type"),loading=!1,org_label=$(this).text(),loading_text=$(this).attr("data-loading-text");if("compact"==type)var last_year=parent_wrp.find(".compact-year:last").data("section-title");else var last_year=parent_wrp.find(".timeline-year:last").data("section-title");var alternate=parent_wrp.find(".timeline-post:last").data("alternate");if("story-tm"==tm_type)var all_attrs=ctlloadmore.attribute,ajax_url=ctlloadmore.url;else var all_attrs=ct_load_more.attribute,ajax_url=ct_load_more.url;var showPosts=$(".cool-timeline-wrapper").attr("data-showposts"),countPages=Math.ceil(totalPosts/showPosts);if($(".ctl_load_more").attr("data-max-num-pages",countPages),page=2,totalPosts>showPosts?$(this).parents(".cool_timeline").find(".ctl_load_more").show():$(this).parents(".cool_timeline").find(".ctl_load_more").hide(),all_attrs.category=termSlug,!loading){"compact"==type?parent_wrp.find(".clt-compact-cont").html(" "):parent_wrp.find(".cooltimeline_cont").html(" "),loading=!0;var data={action:action,last_year:last_year,alternate:alternate,termslug:termSlug,attribute:all_attrs};$.post(ajax_url,data,function(res){if("string"==typeof res&&"undefined"!=res&&(res=JSON.parse(res)),res.success){var $grid;if("compact"==type)if(void 0!==res.data&&""!=res.data)parent_wrp.find(".clt-compact-cont").append('<div class="center-line"></div>'),ctl_compact_settings(parent_wrp.find(".clt-compact-cont").append(res.data)),parent_wrp.find(".ctl_load_more").removeClass("clt-hide-it");else parent_wrp.find(".ctl_load_more").addClass("clt-hide-it");else void 0!==res.data&&""!=res.data?(parent_wrp.find(".cooltimeline_cont").append(res.data),parent_wrp.find(".ctl_load_more").removeClass("clt-hide-it")):parent_wrp.find(".ctl_load_more").addClass("clt-hide-it");loading=!1,preloader.hide(),$(parent_wrp).find(".timeline-main-title").text(cat_name),$(parent_wrp).find(".no-content").hide(),enable_navi(parent_wrp),re_enable_pp(parent_wrp)}}).fail(function(xhr,textStatus,e){console.log(xhr.responseText)})}})});